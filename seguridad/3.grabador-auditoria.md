## Grabador de auditoria (no olvides apuntar a master)

```sql
    CREATE SERVER AUDIT [MiAuditoriaServidor]
    TO FILE (FILEPATH = 'C:\SQLAuditLogs\')
    WITH (QUEUE_DELAY = 1000, ON_FAILURE = CONTINUE);
    GO

    ALTER SERVER AUDIT [MiAuditoriaServidor] WITH (STATE = ON);
    GO
```

## Crear una especificacion de Auditoria


```sql
USE MiEmpresaDB;
GO

CREATE DATABASE AUDIT SPECIFICATION [MiEmpresaDB_Auditoria_DML]
FOR SERVER AUDIT [MiAuditoriaServidor] -- Asume que ya existe una auditoría de servidor
ADD (SELECT ON SCHEMA::HR BY [UsuarioRRHH]),  -- Audita lecturas en el esquema HR por UsuarioRRHH
ADD (UPDATE ON HR.Empleados BY [UsuarioRRHH]),  -- Audita actualizaciones en la tabla Empleados por UsuarioRRHH
ADD (DELETE ON HR.Empleados BY [UsuarioRRHH]),  -- Audita borrados en la tabla Empleados por UsuarioRRHH
ADD (INSERT ON HR.Empleados BY [UsuarioRRHH]),  -- Audita inserciones en la tabla Empleados por UsuarioRRHH
ADD (SELECT ON SCHEMA::FN BY [UsuarioFinanzas]),  -- Audita lecturas en el esquema FN por UsuarioFinanzas
ADD (UPDATE ON FN.Facturas BY [UsuarioFinanzas]),  -- Audita actualizaciones en la tabla Facturas por UsuarioFinanzas
ADD (DELETE ON FN.Facturas BY [UsuarioFinanzas]),  -- Audita borrados en la tabla Facturas por UsuarioFinanzas
ADD (INSERT ON FN.Facturas BY [UsuarioFinanzas]),  -- Audita inserciones en la tabla Facturas por UsuarioFinanzas
ADD (SELECT ON SCHEMA::HR BY [UsuarioAuditor]),  -- Audita lecturas en el esquema HR por UsuarioAuditor
ADD (SELECT ON SCHEMA::FN BY [UsuarioAuditor])  -- Audita lecturas en el esquema FN por UsuarioAuditor
WITH (STATE = ON);  -- Activa esta especificación de auditoría
GO

```