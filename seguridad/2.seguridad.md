## Creaci√≥n y gestion de usuarios y roles

```sql
-- Creamos inicio de sesion (logins) a nivel de instancia sql server
CREATE LOGIN [LoginRRHH] WITH PASSWORD = 'AcademyRecursos!', CHECK_POLICY = ON;
CREATE LOGIN [LoginFinanzas] WITH PASSWORD = 'AcademyFinanzas!', CHECK_POLICY = ON;
CREATE LOGIN [LoginAuditor] WITH PASSWORD = 'AcademyAuditor!', CHECK_POLICY = ON;
GO

USE MiEmpresaDB;
GO
-- Crear usuarios de base de datos y asociarlos a los logins.

CREATE USER [UsuarioRRHH] FOR LOGIN [LoginRRHH];
CREATE USER [UsuarioFinanzas] FOR LOGIN [LoginFinanzas];
CREATE USER [UsuarioAuditor] FOR LOGIN [LoginAuditor];
GO

-- Crear roles de base de datos.
-- Un rol es un grupo con permisos especificos, Se asigna a usuarios para darles esos permisos sin hacerlo uno por uno.
CREATE ROLE [Rol_GerenteRRHH];
CREATE ROLE [Rol_GerenteFinanzas];
CREATE ROLE [Rol_AuditorDatos];
GO
```

## Control de acceso

```sql

USE MiEmpresaDB;
GO
-- Permisos para el Rol_GerenteRRHH:
-- Puede seleccionar, insertar, actualizar y eliminar en la tabla HR.Empleados
GRANT SELECT, INSERT, UPDATE, DELETE ON HR.Empleados TO [Rol_GerenteRRHH];
-- Puede seleccionar datos de la tabla FN.Facturas (solo lectura)
GRANT SELECT ON FN.Facturas TO [Rol_GerenteRRHH];

-- Permisos para el Rol_GerenteFinanzas:
-- Puede seleccionar, insertar, actualizar y eliminar en la tabla FN.Facturas
GRANT SELECT, INSERT, UPDATE, DELETE ON FN.Facturas TO [Rol_GerenteFinanzas];
-- Puede seleccionar solo algunas columnas de la tabla HR.Empleados
GRANT SELECT ON HR.Empleados (EmpleadoID, Nombre, Apellido, Salario) TO [Rol_GerenteFinanzas];

-- Permisos para el Rol_AuditorDatos:
-- Puede seleccionar datos de ambas tablas (solo lectura)
GRANT SELECT ON HR.Empleados TO [Rol_AuditorDatos];
GRANT SELECT ON FN.Facturas TO [Rol_AuditorDatos];

-- Asignar usuarios a roles.
ALTER ROLE [Rol_GerenteRRHH] ADD MEMBER [UsuarioRRHH];
ALTER ROLE [Rol_GerenteFinanzas] ADD MEMBER [UsuarioFinanzas];
ALTER ROLE [Rol_AuditorDatos] ADD MEMBER [UsuarioAuditor];
GO
```